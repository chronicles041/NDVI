"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{177:function(e,t,n){n.r(t),n.d(t,{default:function(){return V}});var a=n(5893),r=n(7294),i=n(9669),s=n.n(i);function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var l="https://app.teamonetech.com/api/v1/",c=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,(n=[{key:"addNewField",value:function(e){return s().post(l+"farm-details/",e)}},{key:"fetchFarmList",value:function(e){return s().get(l+"farm_info_view/",{params:e})}},{key:"getDateImage",value:function(e){return console.log("Param From Service for Image Dates ",e),s().get(l+"export_image/",{params:e})}},{key:"getDisasterImage",value:function(e){return s().get(l+"export_image",{params:e})}}])&&o(t.prototype,n),a&&o(t,a),e}()),u=n(5430),f=n(3160),d=n(6171),p=n(8073),m=n(381),v=n.n(m);function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){g(e,t,n[t])}))}return e}function k(e,t){return!t||"object"!==w(t)&&"function"!==typeof t?h(e):t}function j(e,t){return j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},j(e,t)}var w=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=y(e);if(t){var r=y(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return k(this,n)}}var D={selectedDate:"",marks:{},visibleMarks:{currentIndex:0,totalDates:null,marks:{}},markerIndex:0},S=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(s,e);var t,n,r,i=O(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),g(h(t=i.call(this,e)),"createMarkers",(function(){var e={};t.props.mapData.map((function(t,n){return e=x({},e,g({},n,{style:{color:"#374151",fontSize:"7px"},label:(0,a.jsx)("strong",{children:v()(t.date).format("Do MMM, yy")})})),null})),t.setState({marks:e,visibleMarks:x({},t.state.visibleMarks,{totalDates:Object.keys(e).length})},(function(){t.makeVisibleMarker(!1,!1)}))})),g(h(t),"makeVisibleMarker",(function(e,n){var a=t.state.marks,r=t.state.visibleMarks.currentIndex,i=e===n?r:n?r+8:r-8,s=Object.keys(a).length,o={};if(s<8)t.setState({visibleMarks:{currentIndex:0,marks:a,totalDates:Object.keys(a).length,loading:!1}});else if(s>7){for(var l=0,c=i;c<i+8;c++)a[c]&&(o=x({},o,g({},l,a[c])),l++);t.setState({visibleMarks:x({},t.state.visibleMarks,{currentIndex:i,marks:o}),loading:!1})}})),g(h(t),"onChange",(function(e){t.props.selectedIndex(t.props.mapData[e]),t.setState({selectedDate:t.props.mapData[e].date,markerIndex:e})})),g(h(t),"createDateMarks",(function(){var e=t.state,n=e.visibleMarks;e.marks;return n.marks})),t.state=D,t}return t=s,(n=[{key:"componentDidUpdate",value:function(e,t){if(e.mapData!==this.props.mapData){var n=this;this.setState({initialState:D},(function(){n.createMarkers()}))}}},{key:"render",value:function(){var e=this,t=this.state,n=t.visibleMarks,r=t.marks;return(0,a.jsx)("div",{className:"flex flex-row w-full justify-center items-center p-5",children:this.props.loading?(0,a.jsx)(f.Z,{spin:!0}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"basis-[2%]",children:[(0,a.jsx)(d.Z,{hidden:0===n.currentIndex,onClick:function(){e.makeVisibleMarker(!0,!1)}}),(0,a.jsx)(d.Z,{hidden:n.marks[0]!==r[0],onClick:function(){e.props.getNewDates(!0,!1)},color:"red"})]}),(0,a.jsxs)("div",{className:"basis-[96%] w-full flex flex-col justify-center items-center",children:[(0,a.jsx)(u.Z,{disabled:this.props.loading,min:0,reverse:!0,tipFormatter:null,max:Object.keys(n.marks).length-1,marks:this.createDateMarks(),defaultValue:this.state.markerIndex,value:this.state.markerIndex,onChange:this.onChange}),(0,a.jsxs)("div",{className:"",children:[(0,a.jsxs)("span",{className:"text-white text-base font-semibold",children:[Object.keys(n.marks).length," of total"]})," ",(0,a.jsxs)("span",{className:"text-white text-base font-semibold",children:[Object.keys(r).length," records ."]})]})]}),(0,a.jsx)("div",{className:"basis-[2%]",children:(0,a.jsx)(p.Z,{hidden:n.marks[Object.keys(n.marks).length-1]===r[n.totalDates-1],onClick:function(){e.makeVisibleMarker(!1,!0)}})})]})})}}])&&b(t.prototype,n),r&&b(t,r),s}(r.Component),_=n(7229);var P=function(e){var t,n,r,i,s,o,l=e.graphData,c=(e.loading,{series:[{name:"Performance",data:null===l||void 0===l||null===(t=l.ndvi)||void 0===t?void 0:t.map((function(e){return e.ndvi_value}))}],options:{xaxis:{categories:null===l||void 0===l||null===(n=l.ndvi)||void 0===n?void 0:n.map((function(e){return e.date})),title:{text:"Date"}},yaxis:{title:{text:"NDVI Performance"}},options:{chart:{type:"area",height:350,zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight"},title:{text:"Fundamental Analysis of Stocks",align:"left"},subtitle:{text:"Price Movements",align:"left"},legend:{horizontalAlign:"left"}}}}),u={series:[{name:"NDWI Performance",data:null===l||void 0===l||null===(r=l.ndwi)||void 0===r?void 0:r.map((function(e){return e.ndwi_value}))}],options:{xaxis:{categories:null===l||void 0===l||null===(i=l.ndvi)||void 0===i?void 0:i.map((function(e){return e.date})),title:{text:"Date"}},yaxis:{title:{text:"NDWI Performance"}},options:{chart:{type:"area",height:350,zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight"},title:{text:"Fundamental Analysis of Stocks",align:"left"},subtitle:{text:"Price Movements",align:"left"},legend:{horizontalAlign:"left"}}}};return(0,a.jsxs)(a.Fragment,{children:[(null===l||void 0===l||null===(s=l.ndvi)||void 0===s?void 0:s.length)>0?(0,a.jsx)(_.Z,{options:c.options,series:c.series,type:"area",height:300}):(0,a.jsx)(a.Fragment,{}),(null===l||void 0===l||null===(o=l.ndwi)||void 0===o?void 0:o.length)>0?(0,a.jsx)(_.Z,{options:u.options,series:u.series,type:"area",height:300}):(0,a.jsx)(a.Fragment,{})]})},M=n(5152),N=n(7479);function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=(0,M.default)((function(){return Promise.all([n.e(269),n.e(368)]).then(n.bind(n,7368))}),{loadableGenerated:{webpack:function(){return[7368]}},ssr:!1}),F={addView:!1,listView:!0,detailView:!1};var V=function(e){var t=(0,r.useRef)(),n=(0,r.useState)([]),i=n[0],s=n[1],o=(0,r.useState)([102.8312416766951,15.248647579054131]),l=o[0],u=o[1],f=(0,r.useState)(F),d=f[0],p=(f[1],(0,r.useState)()),m=(p[0],p[1]),v=(0,r.useState)([]),h=v[0],b=v[1],g=(0,r.useState)({}),y=g[0],x=g[1],k=(0,r.useState)({}),j=k[0],w=k[1],O=(0,r.useState)(""),D=O[0],_=O[1],M=(0,r.useState)(!1),V=M[0],E=M[1],R=(0,r.useState)({}),Z=(R[0],R[1],(0,r.useState)({})),z=Z[0],A=Z[1],L=(0,r.useState)({}),T=L[0],G=L[1],B=(0,r.useState)(!1),W=(B[0],B[1],function(e,t,n){var a={farm_id:e.farm_id,previous:t,previous_date:n};c.getDateImage(a).then((function(e){var t=e.data.data.concat(h);b(t),E(!1),b(e.data.data),_(e.data.previous_date),G({ndvi:e.data.ndviGraph,ndwi:e.data.ndwiGraph}),console.log("Data:",data)})).catch((function(e){return E(!1)}))});return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"container bg-white px-4 py-4",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-x-3",children:[(0,a.jsxs)("div",{className:"basis-3/4",children:[(0,a.jsx)(C,{polygon:i,center:l,ref:function(e){return t},viewControl:d,newFarmArray:m,selectedData:y,configureColorPalate:function(e,t){return A(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){I(e,t,n[t])}))}return e}({},z,I({},e,t)))}}),(0,a.jsx)("div",{className:"dateList bg-primary flex justify-center items-center w-full mt-3",children:(0,a.jsx)(S,{loading:V,mapData:h,selectedIndex:x,getNewDates:function(e,t){E(!0),W(j,"True",D)}})})]}),(0,a.jsx)("div",{className:"basis-1/4 flex-col flex justify-between items-center",children:(0,a.jsx)(N.default,{loading:V,selectedItem:function(e){E(!0),s(e.farm_polygon_json.location),u(e.extra_field.centroid),w(e),W(e,"False",null),console.log("Selected Farm :",e),console.log("Polygon :",Object.values(e.farm_polygon_json)),console.log("Center :",e.extra_field.centroid)},listView:!0})})]}),(0,a.jsx)("div",{hidden:V,className:"pt-10 ",children:(0,a.jsx)(P,{graphData:T})})]})})}}}]);